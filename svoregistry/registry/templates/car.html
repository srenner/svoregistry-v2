{% extends 'base.html' %}
{% load filters %}
{% block title %}Mustang SVO Registry{% endblock %}
{% block head %}
{% load staticfiles %}
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@svoregistry">
	<meta name="twitter:title" content="{{car.year}} {{car.COLOR_CHOICES|color_lookup:car.color}} SVO {{car.vin}}">
	<meta name="twitter:description" content="{{twitter_description|truncatechars:200|striptags}}">
	<meta name="twitter:domain" content="SVOregistry.com">
	<link rel="stylesheet" type="text/css" href="{% static 'registry/css/vendor/pikaday.css' %}" />
{% endblock %}

{% load humanize %}
{%block content %}
<header>
	<h1>
		{{car.year|default_if_none:"Unknown Year"}} 
		{{ car.COLOR_CHOICES|color_lookup:car.color }}
		SVO
	</h1>
	<p class="text-center">VIN {{car.vin}}</p>	
</header>

<div class="row">
	<div id="divMap" class="map-small col-md-8 text-center"></div>
	<div id="divMeta" class="col-md-4">
		{% include 'metadata.html' %}
	</div>
</div>
<hr>

<div class="row col-md-12 text-center">
	<a name="entries"></a>
	<h2 class="inline-header">Entries</h2>
	<button id="btnShowForm" class="btn btn-lg btn-default" style="display: none" onclick="document.getElementById('divEntry').style.display=''"><span class="glyphicon glyphicon-plus-sign"></span> Add Entry</button>
</div>

<div class="row"></div>

<div class="registry-entry row container" id="divEntry">
	<div class="row registry-entry-header svo-{{car.color}}">
		<div class="col-md-12 col-sm-12">
			Add Entry for VIN {{car.vin}}
		</div>
	</div>
	<form role="form" id="formAdd" name="formAdd" enctype="multipart/form-data" method="post" action="/add" onsubmit="return addEntryAjax()">
		{% csrf_token %}
		<span class="hidden">{{ form.car }}</span>
		<div class="row hidden">
			<div id="divForSale" class="col-md-3">
				<span>{{ form.for_sale }}</span>
				<label for={{ form.for_sale.auto_id }}>
					Car is for sale
				</label>
			</div>
		</div>
		<div class="row">
			<span class="form-field col-md-3">{{ form.entry_datetime.label_tag }} <span class="datepicker">{{ form.entry_datetime }}</span></span>	
			<span class="form-field col-md-3">{{ form.mileage.label_tag }} {{ form.mileage }}</span>
			<span class="form-field col-md-3">{{ form.owner.label_tag }} {{ form.owner }}</span>
		</div>
		<div class="row">
			<span class="form-field col-md-3">{{ form.city.label_tag }} {{ form.city }}</span>
			<span class="form-field col-md-3">{{ form.state.label_tag }} {{ form.state }}</span>
			<span class="form-field col-md-3">{{ form.country.label_tag }} {{ form.country }}</span>
			<span class="form-field col-md-2">{{ form.zipcode.label_tag }} {{ form.zipcode }}</span>
		</div>
		<hr>
		<div class="row">		
			<span class="form-field col-md-2">{{ form.year.label_tag }} {{ form.year }}</span>
			<span id="spanSlappers" class="form-field col-md-2">{{ form.slappers.label_tag }} {{ form.slappers }}</span>
			<span class="form-field col-md-2">{{ form.interior.label_tag }} {{ form.interior }}</span>
			<span class="form-field col-md-2">{{ form.sunroof.label_tag }} {{ form.sunroof }}</span>
			<span class="form-field col-md-2">{{ form.comp_prep.label_tag }} {{ form.comp_prep }}</span>
			<span id="spanOptionDelete" class="form-field col-md-2">{{ form.option_delete.label_tag }} {{ form.option_delete }}</span>
			<span class="form-field col-md-2">{{ form.wing_delete.label_tag }} {{ form.wing_delete }}</span>
			<span class="form-field col-md-2">{{ form.has_23.label_tag }} {{ form.has_23 }}</span>
			<span class="form-field col-md-2">{{ form.on_road.label_tag }} {{ form.on_road }}</span>
			<span id="spanDeceased" class="form-field col-md-2">{{ form.deceased.label_tag }} {{ form.deceased }}</span>
			<span class="form-field col-md-4">{{ form.color.label_tag }} {{ form.color }} </span>
		</div>
		<hr>
		<div class="row">
			<span class="form-field col-md-6">{{ form.photo.label_tag }} {{ form.photo }}</span>
		</div>
		<div class="row">
			<span class="form-field col-md-12">
				<label class="">Entry Comments:</label>				
			</span>
		</div>
		<div class="row">
			<span class="form-field col-md-12">{{ form.comments }}</span>
		</div>
		<hr>
		<div class="row spacer-small">
			<div class="btn-toolbar col-md-12">
				<button class="btn btn-lg btn-success" type="submit">Save</button>				
				<button id="btnCancel" class="btn btn-lg btn-default" type="button">Cancel</button>	
			</div>
		</div>
	</form>
</div>
<div id="divEntries" class="row col-md-12">
	{% for entry in entries %}
		{% include 'entry.html' %}
	{% endfor %}
</div>

{% endblock %}
{% block scripts %}
<script type="text/javascript">
	var activeCar = "{{car.vin}}";
	document.getElementById("{{ form.year.auto_id }}").value = "{{ car.year }}";
	document.getElementById("{{ form.slappers.auto_id }}").value = "{{ car.slappers|yesno:'2,3,1' }}";
	document.getElementById("{{ form.color.auto_id }}").value = "{{ car.color }}";
	document.getElementById("{{ form.interior.auto_id }}").value = "{{ car.interior }}";
	document.getElementById("{{ form.sunroof.auto_id }}").value = "{{ car.sunroof|yesno:'2,3,1' }}";
	document.getElementById("{{ form.comp_prep.auto_id }}").value = "{{ car.comp_prep|yesno:'2,3,1' }}";
	document.getElementById("{{ form.option_delete.auto_id }}").value = "{{ car.option_delete|yesno:'2,3,1' }}";
	document.getElementById("{{ form.wing_delete.auto_id }}").value = "{{ car.wing_delete|yesno:'2,3,1' }}";
	document.getElementById("{{ form.has_23.auto_id }}").value = "{{ car.has_23|yesno:'2,3,1' }}";
	document.getElementById("{{ form.deceased.auto_id }}").value = "{{ car.deceased|yesno:'2,3,1' }}";
	document.getElementById("{{ form.car.auto_id }}").value = "{{car.vin}}";
</script>
<script src="{% static 'registry/js/vendor/tinymce/tinymce.min.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/vendor/tinymce/themes/modern/theme.min.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/vendor/moment.min.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/vendor/pikaday.js' %}" type="text/javascript"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script src="{% static 'registry/js/vendor/markerclusterer_compiled.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/vendor/oms.min.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/car.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/svo-colors.js' %}" type="text/javascript"></script>
<script src="{% static 'registry/js/entry.js' %}" type="text/javascript"></script>
{% endblock %}
